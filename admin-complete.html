<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ğŸ åº—èˆ—ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã€å®Œå…¨ç‰ˆã€‘</title></head><body style="margin:0;padding:0;font-family:'Hiragino Sans','Yu Gothic',Arial,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;">

<div style="max-width:1600px;margin:0 auto;background:white;border-radius:20px;overflow:hidden;box-shadow:0 20px 40px rgba(0,0,0,0.3);">

<div style="background:linear-gradient(135deg,#2c5f2d 0%,#4a7c59 100%);color:white;padding:40px;text-align:center;">
<h1 style="font-size:36px;font-weight:bold;margin:0 0 10px 0;">ğŸ åº—èˆ—ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã€å®Œå…¨ç‰ˆã€‘</h1>
<p style="font-size:18px;opacity:0.9;margin:0;">ãƒ“ãƒ¨ãƒ³ãƒ‰ã‚°ãƒ«ãƒ†ãƒ³ãƒ•ãƒªãƒ¼ç¥­ã‚Š 2025 - ç™»éŒ²ãƒ»ç·¨é›†ãƒ»å‰Šé™¤</p>
</div>

<div style="padding:20px;border-bottom:2px solid #eee;">
<div style="display:flex;justify-content:center;gap:15px;flex-wrap:wrap;">
<button onclick="showSection('list')" id="btn-list" style="background:#2c5f2d;color:white;border:none;padding:12px 24px;border-radius:25px;font-size:16px;cursor:pointer;font-weight:bold;">ğŸ“‹ åº—èˆ—ä¸€è¦§</button>
<button onclick="showSection('add')" id="btn-add" style="background:#4a90e2;color:white;border:none;padding:12px 24px;border-radius:25px;font-size:16px;cursor:pointer;font-weight:bold;">ğŸ†• æ–°è¦ç™»éŒ²</button>
<button onclick="exportData()" style="background:#e74c3c;color:white;border:none;padding:12px 24px;border-radius:25px;font-size:16px;cursor:pointer;font-weight:bold;">ğŸ’¾ ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›</button>
</div>
</div>

<div id="section-list" style="display:block;">
<div style="padding:30px;text-align:center;">
<div id="status" style="background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);color:#d2691e;padding:20px;border-radius:15px;font-size:18px;font-weight:bold;margin-bottom:30px;">
<span style="display:inline-block;width:25px;height:25px;border:3px solid #f3f3f3;border-top:3px solid #2c5f2d;border-radius:50%;animation:spin 1s linear infinite;margin-right:10px;"></span>
åº—èˆ—ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...
</div>
</div>
<div id="shops-list" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));gap:25px;padding:0 30px 30px;"></div>
</div>

<div id="section-add" style="display:none;padding:40px;">
<h2 style="color:#2c5f2d;text-align:center;margin-bottom:30px;font-size:28px;">ğŸ†• æ–°è¦åº—èˆ—ç™»éŒ²</h2>
<form id="shop-form" style="max-width:800px;margin:0 auto;">
<div style="display:grid;gap:20px;">

<div>
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">åº—èˆ—å *</label>
<input type="text" id="shop-name" required style="width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:16px;">
</div>

<div>
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">ä½æ‰€</label>
<input type="text" id="shop-address" style="width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:16px;">
</div>

<div>
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">ã‚«ãƒ†ã‚´ãƒªï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
<div style="display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;">
<label style="display:flex;align-items:center;"><input type="checkbox" value="ã‚¹ã‚¤ãƒ¼ãƒ„" style="margin-right:5px;"> ã‚¹ã‚¤ãƒ¼ãƒ„</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="é£Ÿäº‹" style="margin-right:5px;"> é£Ÿäº‹</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="ãƒ‘ãƒ³" style="margin-right:5px;"> ãƒ‘ãƒ³</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="ãƒ‰ãƒªãƒ³ã‚¯" style="margin-right:5px;"> ãƒ‰ãƒªãƒ³ã‚¯</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="èª¿å‘³æ–™" style="margin-right:5px;"> èª¿å‘³æ–™</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="ã‚°ãƒƒã‚º" style="margin-right:5px;"> ã‚°ãƒƒã‚º</label>
</div>
</div>

<div>
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">ç‰¹å¾´ãƒ»ã‚¿ã‚°ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
<div style="display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;">
<label style="display:flex;align-items:center;"><input type="checkbox" value="å°éº¦ä¸ä½¿ç”¨" style="margin-right:5px;"> å°éº¦ä¸ä½¿ç”¨</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="åµä¸ä½¿ç”¨" style="margin-right:5px;"> åµä¸ä½¿ç”¨</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="ä¹³ä¸ä½¿ç”¨" style="margin-right:5px;"> ä¹³ä¸ä½¿ç”¨</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="ãƒŠãƒƒãƒ„ä¸ä½¿ç”¨" style="margin-right:5px;"> ãƒŠãƒƒãƒ„ä¸ä½¿ç”¨</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="æœ‰æ©Ÿ" style="margin-right:5px;"> æœ‰æ©Ÿ</label>
<label style="display:flex;align-items:center;"><input type="checkbox" value="ãƒ´ã‚£ãƒ¼ã‚¬ãƒ³å¯¾å¿œ" style="margin-right:5px;"> ãƒ´ã‚£ãƒ¼ã‚¬ãƒ³å¯¾å¿œ</label>
</div>
</div>

<div>
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">ç°¡æ½”ãªèª¬æ˜</label>
<input type="text" id="shop-short" style="width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:16px;" placeholder="ä¾‹: ç±³ç²‰ã‚±ãƒ¼ã‚­ã¨ã‚¹ãƒšã‚·ãƒ£ãƒªãƒ†ã‚£ã‚³ãƒ¼ãƒ’ãƒ¼ã®å°‚é–€åº—">
</div>

<div>
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">ã‚³ãƒ³ã‚»ãƒ—ãƒˆ</label>
<textarea id="shop-concept" rows="4" style="width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:16px;resize:vertical;" placeholder="åº—èˆ—ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚„æƒ³ã„ã‚’å…¥åŠ›"></textarea>
</div>

<div>
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">å¯¾è±¡é¡§å®¢</label>
<textarea id="shop-target" rows="3" style="width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:16px;resize:vertical;" placeholder="ã©ã®ã‚ˆã†ãªé¡§å®¢ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã—ã¦ã„ã‚‹ã‹"></textarea>
</div>

<div>
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">Instagram URL</label>
<input type="url" id="shop-instagram" style="width:100%;padding:12px;border:2px solid #ddd;border-radius:8px;font-size:16px;" placeholder="https://instagram.com/your-account">
</div>

<div id="menu-section">
<label style="display:block;font-weight:bold;margin-bottom:8px;color:#333;">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</label>
<div id="menu-items"></div>
<button type="button" onclick="addMenuItem()" style="background:#4a90e2;color:white;border:none;padding:10px 20px;border-radius:20px;margin-top:10px;cursor:pointer;">+ ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ </button>
</div>

<div style="text-align:center;margin-top:30px;">
<button type="submit" style="background:linear-gradient(135deg,#2c5f2d,#4a7c59);color:white;border:none;padding:15px 40px;border-radius:25px;font-size:18px;font-weight:bold;cursor:pointer;">ğŸ’¾ åº—èˆ—ã‚’ç™»éŒ²</button>
<button type="button" onclick="resetForm()" style="background:#6c757d;color:white;border:none;padding:15px 40px;border-radius:25px;font-size:18px;font-weight:bold;cursor:pointer;margin-left:15px;">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
</div>

</div>
</form>
</div>

<div id="edit-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:1000;">
<div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:white;border-radius:20px;padding:40px;max-width:800px;width:90%;max-height:90%;overflow-y:auto;">
<h2 style="color:#2c5f2d;text-align:center;margin-bottom:30px;">âœï¸ åº—èˆ—æƒ…å ±ç·¨é›†</h2>
<div id="edit-form-content"></div>
</div>
</div>

</div>

<style>
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
.shop-card { background:linear-gradient(135deg,#ffffff 0%,#f8f9fa 100%); border:2px solid #2c5f2d; border-radius:15px; padding:25px; box-shadow:0 8px 20px rgba(44,95,45,0.15); transition:all 0.3s ease; position:relative; }
.shop-card:hover { transform:translateY(-5px); box-shadow:0 12px 30px rgba(44,95,45,0.25); }
.shop-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; padding-bottom:15px; border-bottom:2px solid #f0f0f0; }
.shop-name { font-size:22px; font-weight:bold; color:#2c5f2d; margin:0; }
.shop-id { background:#2c5f2d; color:white; padding:6px 12px; border-radius:15px; font-size:12px; font-weight:bold; }
.shop-info { margin:10px 0; font-size:14px; color:#555; }
.shop-actions { display:flex; gap:10px; margin-top:15px; }
.btn-edit { background:#4a90e2; color:white; border:none; padding:8px 16px; border-radius:20px; font-size:14px; cursor:pointer; font-weight:bold; }
.btn-delete { background:#e74c3c; color:white; border:none; padding:8px 16px; border-radius:20px; font-size:14px; cursor:pointer; font-weight:bold; }
.btn-edit:hover { background:#357abd; }
.btn-delete:hover { background:#c0392b; }
.status-success { background:linear-gradient(135deg,#a8e6cf 0%,#7fcdcd 100%); color:#2e7d32; padding:20px; border-radius:15px; font-size:18px; font-weight:bold; }
.status-error { background:linear-gradient(135deg,#ffb3ba 0%,#ff9999 100%); color:#c62828; padding:20px; border-radius:15px; font-size:18px; font-weight:bold; }
.menu-item-input { display:flex; gap:10px; margin-bottom:10px; align-items:center; }
.menu-item-input input { flex:1; padding:8px 12px; border:1px solid #ddd; border-radius:5px; }
.menu-item-input button { background:#e74c3c; color:white; border:none; padding:8px 12px; border-radius:5px; cursor:pointer; }
</style>

<script>
var API_BASE = 'https://gf-fes-api.bettger1000.workers.dev/api';
var shops = [];
var editingShopId = null;
var menuCounter = 0;

console.log('ğŸš€ å®Œå…¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•');
loadShops();

function showSection(section) {
  document.getElementById('section-list').style.display = section === 'list' ? 'block' : 'none';
  document.getElementById('section-add').style.display = section === 'add' ? 'block' : 'none';
  
  document.getElementById('btn-list').style.background = section === 'list' ? '#2c5f2d' : '#6c757d';
  document.getElementById('btn-add').style.background = section === 'add' ? '#4a90e2' : '#6c757d';
  
  if (section === 'list') loadShops();
}

function loadShops() {
  console.log('ğŸ“¡ åº—èˆ—ä¸€è¦§å–å¾—é–‹å§‹');
  var statusDiv = document.getElementById('status');
  statusDiv.className = '';
  statusDiv.innerHTML = '<span style="display:inline-block;width:25px;height:25px;border:3px solid #f3f3f3;border-top:3px solid #2c5f2d;border-radius:50%;animation:spin 1s linear infinite;margin-right:10px;"></span>åº—èˆ—ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...';
  
  var xhr = new XMLHttpRequest();
  xhr.open('GET', API_BASE + '/shops', true);
  xhr.timeout = 20000;
  
  xhr.onload = function() {
    if (xhr.status === 200) {
      try {
        shops = JSON.parse(xhr.responseText);
        console.log('âœ… åº—èˆ—å–å¾—æˆåŠŸ:', shops.length + 'ä»¶');
        displayShops();
      } catch (e) {
        console.error('âŒ JSONè§£æã‚¨ãƒ©ãƒ¼:', e);
        showError('ãƒ‡ãƒ¼ã‚¿è§£æã‚¨ãƒ©ãƒ¼');
      }
    } else {
      console.error('âŒ HTTP ã‚¨ãƒ©ãƒ¼:', xhr.status);
      showError('ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼: ' + xhr.status);
    }
  };
  
  xhr.onerror = function() {
    console.error('âŒ é€šä¿¡ã‚¨ãƒ©ãƒ¼');
    showError('é€šä¿¡ã‚¨ãƒ©ãƒ¼');
  };
  
  xhr.ontimeout = function() {
    console.error('âŒ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ');
    showError('20ç§’ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ');
  };
  
  xhr.send();
}

function displayShops() {
  var statusDiv = document.getElementById('status');
  var listDiv = document.getElementById('shops-list');
  
  if (!shops || shops.length === 0) {
    statusDiv.className = 'status-error';
    statusDiv.innerHTML = 'âš ï¸ ç™»éŒ²æ¸ˆã¿åº—èˆ—ãŒã‚ã‚Šã¾ã›ã‚“';
    listDiv.innerHTML = '';
    return;
  }
  
  statusDiv.className = 'status-success';
  statusDiv.innerHTML = 'âœ… ' + shops.length + 'ä»¶ã®åº—èˆ—ã‚’ç®¡ç†ä¸­';
  
  var html = '';
  for (var i = 0; i < shops.length; i++) {
    var shop = shops[i];
    html += buildShopCard(shop);
  }
  
  listDiv.innerHTML = html;
  console.log('ğŸ‰ åº—èˆ—ä¸€è¦§è¡¨ç¤ºå®Œäº†');
}

function buildShopCard(shop) {
  var html = '<div class="shop-card">';
  
  html += '<div class="shop-header">';
  html += '<h3 class="shop-name">' + escape(shop.name || 'åå‰æœªè¨­å®š') + '</h3>';
  html += '<span class="shop-id">' + escape(shop.id || 'IDæœªè¨­å®š') + '</span>';
  html += '</div>';
  
  if (shop.address) {
    html += '<div class="shop-info">ğŸ“ ' + escape(shop.address) + '</div>';
  }
  
  if (shop.category && shop.category.length) {
    html += '<div class="shop-info">ğŸ·ï¸ ' + shop.category.map(escape).join(', ') + '</div>';
  }
  
  if (shop.short) {
    html += '<div class="shop-info">â­ ' + escape(shop.short) + '</div>';
  }
  
  html += '<div class="shop-actions">';
  html += '<button class="btn-edit" onclick="editShop(\'' + escape(shop.id) + '\')">âœï¸ ç·¨é›†</button>';
  html += '<button class="btn-delete" onclick="deleteShop(\'' + escape(shop.id) + '\')">ğŸ—‘ï¸ å‰Šé™¤</button>';
  html += '</div>';
  
  html += '</div>';
  return html;
}

function addMenuItem() {
  menuCounter++;
  var html = '<div class="menu-item-input" id="menu-' + menuCounter + '">';
  html += '<input type="text" placeholder="ãƒ¡ãƒ‹ãƒ¥ãƒ¼å" class="menu-name">';
  html += '<input type="text" placeholder="ä¾¡æ ¼ï¼ˆä»»æ„ï¼‰" class="menu-price" style="max-width:120px;">';
  html += '<button type="button" onclick="removeMenuItem(' + menuCounter + ')">å‰Šé™¤</button>';
  html += '</div>';
  
  document.getElementById('menu-items').insertAdjacentHTML('beforeend', html);
}

function removeMenuItem(id) {
  var element = document.getElementById('menu-' + id);
  if (element) element.remove();
}

document.getElementById('shop-form').addEventListener('submit', function(e) {
  e.preventDefault();
  saveShop();
});

function saveShop() {
  var name = document.getElementById('shop-name').value.trim();
  if (!name) {
    alert('åº—èˆ—åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
    return;
  }
  
  var categories = [];
  var categoryChecks = document.querySelectorAll('input[type="checkbox"]:checked');
  for (var i = 0; i < categoryChecks.length; i++) {
    if (['ã‚¹ã‚¤ãƒ¼ãƒ„','é£Ÿäº‹','ãƒ‘ãƒ³','ãƒ‰ãƒªãƒ³ã‚¯','èª¿å‘³æ–™','ã‚°ãƒƒã‚º'].includes(categoryChecks[i].value)) {
      categories.push(categoryChecks[i].value);
    }
  }
  
  var tags = [];
  for (var i = 0; i < categoryChecks.length; i++) {
    if (['å°éº¦ä¸ä½¿ç”¨','åµä¸ä½¿ç”¨','ä¹³ä¸ä½¿ç”¨','ãƒŠãƒƒãƒ„ä¸ä½¿ç”¨','æœ‰æ©Ÿ','ãƒ´ã‚£ãƒ¼ã‚¬ãƒ³å¯¾å¿œ'].includes(categoryChecks[i].value)) {
      tags.push(categoryChecks[i].value);
    }
  }
  
  var menu = [];
  var menuItems = document.querySelectorAll('.menu-item-input');
  for (var i = 0; i < menuItems.length; i++) {
    var menuName = menuItems[i].querySelector('.menu-name').value.trim();
    var menuPrice = menuItems[i].querySelector('.menu-price').value.trim();
    if (menuName) {
      menu.push({
        name: menuName,
        price: menuPrice || ''
      });
    }
  }
  
  var instagram = document.getElementById('shop-instagram').value.trim();
  var links = {};
  if (instagram) links.instagram = instagram;
  
  var shopData = {
    name: name,
    address: document.getElementById('shop-address').value.trim(),
    category: categories,
    tags: tags,
    short: document.getElementById('shop-short').value.trim(),
    concept: document.getElementById('shop-concept').value.trim(),
    targetCustomer: document.getElementById('shop-target').value.trim(),
    menu: menu,
    links: Object.keys(links).length > 0 ? links : undefined
  };
  
  console.log('ğŸ’¾ åº—èˆ—ä¿å­˜é–‹å§‹:', shopData);
  
  var xhr = new XMLHttpRequest();
  xhr.open('POST', API_BASE + '/shops', true);
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.timeout = 30000;
  
  xhr.onload = function() {
    if (xhr.status === 200 || xhr.status === 201) {
      console.log('âœ… åº—èˆ—ä¿å­˜æˆåŠŸ');
      alert('âœ… åº—èˆ—ã‚’ç™»éŒ²ã—ã¾ã—ãŸï¼');
      resetForm();
      showSection('list');
    } else {
      console.error('âŒ ä¿å­˜ã‚¨ãƒ©ãƒ¼:', xhr.status, xhr.responseText);
      alert('âŒ ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + xhr.status);
    }
  };
  
  xhr.onerror = function() {
    console.error('âŒ é€šä¿¡ã‚¨ãƒ©ãƒ¼');
    alert('âŒ é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
  };
  
  xhr.ontimeout = function() {
    console.error('âŒ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ');
    alert('âŒ 30ç§’ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ');
  };
  
  xhr.send(JSON.stringify(shopData));
}

function resetForm() {
  document.getElementById('shop-form').reset();
  document.getElementById('menu-items').innerHTML = '';
  menuCounter = 0;
  editingShopId = null;
}

function editShop(shopId) {
  console.log('âœï¸ åº—èˆ—ç·¨é›†é–‹å§‹:', shopId);
  var shop = shops.find(function(s) { return s.id === shopId; });
  if (!shop) {
    alert('åº—èˆ—ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    return;
  }
  
  editingShopId = shopId;
  
  // ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã—ã¦è¡¨ç¤º
  // ï¼ˆç°¡ç•¥åŒ–ã®ãŸã‚ã€æ–°è¦ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ç”¨ï¼‰
  showSection('add');
  
  // ãƒ•ã‚©ãƒ¼ãƒ ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›
  document.getElementById('shop-name').value = shop.name || '';
  document.getElementById('shop-address').value = shop.address || '';
  document.getElementById('shop-short').value = shop.short || '';
  document.getElementById('shop-concept').value = shop.concept || '';
  document.getElementById('shop-target').value = shop.targetCustomer || '';
  document.getElementById('shop-instagram').value = (shop.links && shop.links.instagram) || '';
  
  // ã‚«ãƒ†ã‚´ãƒªã¨ã‚¿ã‚°ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’è¨­å®š
  var checks = document.querySelectorAll('input[type="checkbox"]');
  for (var i = 0; i < checks.length; i++) {
    checks[i].checked = false;
    if (shop.category && shop.category.includes(checks[i].value)) {
      checks[i].checked = true;
    }
    if (shop.tags && shop.tags.includes(checks[i].value)) {
      checks[i].checked = true;
    }
  }
  
  // ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¨­å®š
  document.getElementById('menu-items').innerHTML = '';
  menuCounter = 0;
  if (shop.menu) {
    for (var i = 0; i < shop.menu.length; i++) {
      addMenuItem();
      var menuInputs = document.querySelectorAll('.menu-item-input');
      var lastInput = menuInputs[menuInputs.length - 1];
      lastInput.querySelector('.menu-name').value = shop.menu[i].name || '';
      lastInput.querySelector('.menu-price').value = shop.menu[i].price || '';
    }
  }
  
  alert('âœ… ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã—ãŸã€‚ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä¿®æ­£ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„ã€‚');
}

function deleteShop(shopId) {
  if (!confirm('æœ¬å½“ã«ã“ã®åº—èˆ—ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
  
  console.log('ğŸ—‘ï¸ åº—èˆ—å‰Šé™¤é–‹å§‹:', shopId);
  
  var xhr = new XMLHttpRequest();
  xhr.open('DELETE', API_BASE + '/shops/' + shopId, true);
  xhr.timeout = 20000;
  
  xhr.onload = function() {
    if (xhr.status === 200) {
      console.log('âœ… åº—èˆ—å‰Šé™¤æˆåŠŸ');
      alert('âœ… åº—èˆ—ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
      loadShops();
    } else {
      console.error('âŒ å‰Šé™¤ã‚¨ãƒ©ãƒ¼:', xhr.status);
      alert('âŒ å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + xhr.status);
    }
  };
  
  xhr.onerror = function() {
    console.error('âŒ é€šä¿¡ã‚¨ãƒ©ãƒ¼');
    alert('âŒ é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
  };
  
  xhr.ontimeout = function() {
    console.error('âŒ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ');
    alert('âŒ 20ç§’ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ');
  };
  
  xhr.send();
}

function exportData() {
  if (!shops || shops.length === 0) {
    alert('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
    return;
  }
  
  var jsonStr = JSON.stringify(shops, null, 2);
  var blob = new Blob([jsonStr], { type: 'application/json' });
  var url = URL.createObjectURL(blob);
  
  var a = document.createElement('a');
  a.href = url;
  a.download = 'shops-' + new Date().toISOString().slice(0,19).replace(/:/g,'-') + '.json';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
  
  console.log('ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå®Œäº†');
}

function showError(message) {
  var statusDiv = document.getElementById('status');
  statusDiv.className = 'status-error';
  statusDiv.innerHTML = 'âŒ ' + escape(message);
}

function escape(str) {
  if (typeof str !== 'string') return '';
  return str
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#039;');
}

// åˆæœŸãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ã‚’1ã¤è¿½åŠ 
addMenuItem();
</script>

</body></html>